<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Add Menu Item (Food / Mart)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --bg:#0f172a; --card:#111827; --text:#e5e7eb; --muted:#9ca3af; --accent:#22d3ee; }
    * { box-sizing: border-box; }
    body {
      margin: 0; background: linear-gradient(135deg,#0f172a 0%,#111827 100%);
      min-height: 100vh; color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial;
      display: grid; place-items: center; padding: 24px;
    }
    .card {
      width: 100%; max-width: 820px; background: rgba(17,24,39,.85);
      border: 1px solid rgba(255,255,255,.08); border-radius: 16px; padding: 24px;
      box-shadow: 0 10px 30px rgba(0,0,0,.5); backdrop-filter: blur(8px);
    }
    h1 { margin: 0 0 6px; font-size: 22px; }
    p.lead { margin: 0 0 18px; color: var(--muted); font-size: 14px; }
    .toggle {
      display: flex; gap: 10px; align-items: center; margin-bottom: 14px;
      padding: 10px; border: 1px solid rgba(255,255,255,.1); border-radius: 12px; background:#0b1220;
    }
    .pill { padding: 6px 10px; border-radius: 999px; border:1px solid rgba(255,255,255,.12); }
    .endpoint { color: var(--muted); font-size: 12px; margin-left: auto; }
    form { display: grid; grid-template-columns: 1fr 1fr; gap: 14px 16px; }
    .full { grid-column: 1 / -1; }
    label { display:block; font-size:12px; color: var(--muted); margin-bottom:6px; letter-spacing:.2px; }
    input[type="text"], input[type="number"], select, textarea, input[type="file"] {
      width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,.12);
      background: #0b1220; color: var(--text); outline: none;
    }
    input::file-selector-button {
      border: 1px solid rgba(255,255,255,.15); padding: 8px 12px; border-radius: 8px; background: #0e1628; color: var(--text); margin-right: 10px; cursor: pointer;
    }
    textarea { min-height: 90px; resize: vertical; }
    .btns { display: flex; gap: 12px; margin-top: 8px; }
    button {
      appearance: none; border: 1px solid rgba(255,255,255,.12); background: #0b1220; color: var(--text);
      padding: 10px 16px; border-radius: 10px; cursor: pointer;
    }
    button.primary { border-color: transparent; background: linear-gradient(135deg, #06b6d4, #2563eb); }
    small.hint { color: var(--muted); font-size: 12px; }
    .note { margin-top: 10px; color: var(--muted); font-size: 12px; }
    .preview { margin-top: 8px; border-radius: 10px; border: 1px dashed rgba(255,255,255,.15); padding: 8px; display: none; }
    .preview img { max-width: 100%; border-radius: 8px; display: block; }
    @media (max-width: 760px){ form { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="card">
    <h1>Add Menu Item</h1>
    <p class="lead">Toggle between <strong>Food</strong> and <strong>Mart</strong>. Image is sent as <code>item_image</code> (multipart/form-data).</p>

    <div class="toggle">
      <label class="pill">
        <input type="radio" name="kind" value="food" checked /> Food
      </label>
      <label class="pill">
        <input type="radio" name="kind" value="mart" /> Mart
      </label>
      <span id="endpointLabel" class="endpoint"></span>
    </div>

    <form id="menuForm" method="POST" enctype="multipart/form-data">
      <!-- Required -->
      <div>
        <label for="business_id">Business ID *</label>
        <input id="business_id" name="business_id" type="number" min="1" required placeholder="e.g. 101" />
        <small class="hint">Must exist in <code>merchant_business_details</code>.</small>
      </div>

      <div>
        <label for="category_name">Category Name *</label>
        <input id="category_name" name="category_name" type="text" required placeholder="e.g. Beverages" />
        <small class="hint">Must exist in <code>food_category</code> or <code>mart_category</code> accordingly.</small>
      </div>

      <div>
        <label for="item_name">Item Name *</label>
        <input id="item_name" name="item_name" type="text" required placeholder="e.g. Iced Tea" />
      </div>

      <div>
        <label for="base_price">Base Price *</label>
        <input id="base_price" name="base_price" type="number" step="0.01" min="0" required placeholder="e.g. 4.50" />
      </div>

      <!-- Optional -->
      <div>
        <label for="tax_rate">Tax Rate (%)</label>
        <input id="tax_rate" name="tax_rate" type="number" step="0.01" min="0" placeholder="e.g. 5" />
      </div>

      <div>
        <label for="is_veg">Is Veg (Food mostly)</label>
        <select id="is_veg" name="is_veg">
          <option value="">(not set)</option>
          <option value="1">Yes (1)</option>
          <option value="0">No (0)</option>
        </select>
      </div>

      <div>
        <label for="spice_level">Spice Level (Food mostly)</label>
        <select id="spice_level" name="spice_level">
          <option value="">(not set)</option>
          <option>None</option>
          <option>Mild</option>
          <option>Medium</option>
          <option>Hot</option>
        </select>
      </div>

      <div>
        <label for="is_available">Is Available</label>
        <select id="is_available" name="is_available">
          <option value="">(not set)</option>
          <option value="1">Yes (1)</option>
          <option value="0">No (0)</option>
        </select>
      </div>

      <div>
        <label for="stock_limit">Stock Limit</label>
        <input id="stock_limit" name="stock_limit" type="number" min="0" placeholder="e.g. 50" />
      </div>

      <div>
        <label for="sort_order">Sort Order</label>
        <input id="sort_order" name="sort_order" type="number" step="1" placeholder="e.g. 1" />
      </div>

      <div class="full">
        <label for="description">Description</label>
        <textarea id="description" name="description" placeholder="Short description"></textarea>
      </div>

      <div class="full">
        <label for="item_image">Item Image (file upload)</label>
        <input id="item_image" name="item_image" type="file" accept="image/*" />
        <div id="preview" class="preview"><img id="previewImg" alt="preview" /></div>
        <small class="note">
          Stored as <code>/uploads/&lt;food-menu|mart-menu&gt;/&lt;filename&gt;</code>.
        </small>
      </div>

      <div class="btns full">
        <button type="reset">Reset</button>
        <button class="primary" type="submit">Submit</button>
      </div>
    </form>
  </div>

  <script>
    const ENDPOINTS = {
      food: "http://localhost:9090/api/food-menu",
      mart: "http://localhost:9009/api/mart-menu",
    };

    const form = document.getElementById("menuForm");
    const endpointLabel = document.getElementById("endpointLabel");
    const radios = document.querySelectorAll('input[name="kind"]');

    function updateAction() {
      const kind = document.querySelector('input[name="kind"]:checked').value;
      form.action = ENDPOINTS[kind];
      endpointLabel.textContent = `POST â†’ ${ENDPOINTS[kind]}`;
    }
    radios.forEach(r => r.addEventListener("change", updateAction));
    updateAction();

    // Client-side preview
    const fileInput = document.getElementById('item_image');
    const preview = document.getElementById('preview');
    const img = document.getElementById('previewImg');
    fileInput.addEventListener('change', () => {
      const f = fileInput.files && fileInput.files[0];
      if (!f) { preview.style.display = 'none'; img.src = ''; return; }
      img.src = URL.createObjectURL(f);
      preview.style.display = 'block';
    });
  </script>
</body>
</html>
